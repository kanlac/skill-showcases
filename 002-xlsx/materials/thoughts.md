
介绍 xlsx skill：
- 公式驱动；约定用 pandas 库做数据处理，openpyxl 用于公式/格式化，LibreOffice 用于计算公式
- 包含一个 python 脚本 `recalc.py`，作用是计算公式。有什么用呢？——如果最后用 Excel 或者 WPS 等工具打开，其实是不需要的，它的意义主要在于自动化，比如输出的表格要用于其他程序，或者说需要验证一下算出来的值对不对
- 财务模型的规范。包括各种颜色代表的含义，数字格式标准等等。我查了一下这还真不是随便定的，就是投资银行业的行业惯例，源自华尔街投行（高盛、摩根士丹利、JP摩根等）的内部培训标准
- 定义了公式的构造规则、常见问题和 checklist
- 包含了 python 脚本和表格本身的风格规范，比如只对复杂公式添加必要的注释

体验：
- 无论用什么工具，本质上都是用 python 脚本处理，基本保证了都能给出正确的计算结果
- 但 xlsx skill 会要求用公式而非硬编码，formula bot 和不加载 skill 的情况下，会填入硬编码数据
- 无论用不用 skill，无论是 claude code 还是 formula bot，都不理解表头在第二行，需要明确说明「从第3行开始填写」
- codex 正确识别出了表头！但出现了 `#DIV/0!` 公式错误
- 总结：无论选择哪种工具，都会犯点小错误，但经过提示词迭代都是可以修复的。但这也侧面说明 xlsx skill 设计还不够完善
- 没有银弹，如果你有足够复杂的工作流程，值得专门定制一个 skill。但 claude 官方的 xlsx 是一个不错的基础

要注意什么：
- 一定要备份
- 提示词需要迭代，如果效果不理想，就修改提示词，从之前的数据重来，而不是接着继续改

关于 skill 专用化的感悟：
- 你可能用不到华尔街投行的财务报表规范，或许你有一套自己的规范……所以即便封装为标准化资产，skill 也是有很大操作空间的

如何给 codex 安装 skill：
- 使用 skill-creator skill，把你想安装的 skill 的 github 链接即可，它会自动帮你下载，比如 `/skill-creator https://github.com/anthropics/skills/blob/main/skills/xlsx/SKILL.md`

使用场景：
- 完美契合：财务报表分析与建模，需要自动化处理且已安装 LibreOffice
- 可以用：处理各种复杂表格，.xlsx、.xlsm、.csv、.tsv 等格式，需要使用公式
- 可有可无：一次性的简单表格分析和处理，没有规范化要求，不需要用到公式

其他推荐：
另外，对于经常处理表格的人来说，自然语言或许并不是最合适的工作方式。如果你希望直接在单元格中唤起 AI，那类似 SheetAI 这样的 Google Sheet 插件还挺有用。如果做表格 agent 却不支持表格内部互动，那在我看来真可以歇菜了。

WPS 的 ai 插件，从单元格唤起，却要我复制，这不搞笑么。
![wps-ai](img/wps-ai.jpg)

但 WPS, Excel 这种至少本身有庞大的用户量，推出的 AI 插件倒还有人用。formula bot 这种纯对话式 agent，相对于 claude code 没有优势。