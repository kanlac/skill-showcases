# 标题选项

## 选项 1（推荐）
**让 AI 处理财务报表，为什么你需要一套"华尔街规范"**

*技巧：权威背书（华尔街）+ 悬念（为什么需要）*

## 选项 2
**用 Claude 自动化财务报表：从"能跑"到"专业"的距离**

*技巧：对比反差（能跑 vs 专业）+ 具体工具*

## 选项 3
**AI 填表格，公式 vs 硬编码：这个细节决定了专业度**

*技巧：对比反差（公式 vs 硬编码）+ 具体细节*

## 选项 4
**Claude 官方的 xlsx Skill：为什么它坚持用公式而不是硬编码**

*技巧：权威背书（官方）+ 悬念式提问*

---

# 正文

你有没有试过让 AI 帮你处理财务报表？

我试过。结果嘛，表格是生成出来了，数字也填进去了，但总觉得哪里不对劲。后来仔细一看，发现问题了——AI 把所有计算结果都"硬编码"进了单元格。

什么意思呢？就是说，它直接填了个 `12500`，而不是 `=SUM(B2:B9)`。

表面上看没啥区别，反正数字是对的。但如果你做过财务建模就知道，这种表格交出去是要被打回来的。因为一旦源数据变了，这个"12500"不会跟着变——它只是个死数字。

---

## 市面上的表格 AI 工具，都在卷什么？

2025 年做了个小调研，发现表格处理的 AI agent 已经卷成红海了：

- **Formula Bot**：老牌选手，号称 100 万用户，支持自然语言生成公式
- **Skywork Table Mode**：准确率据说能到 94.5%，比 OpenAI 的 Code Interpreter 高不少
- **SheetAI**：Google Sheets 用户的最爱，支持多个 AI 模型切换
- **Excel Copilot Agent Mode**：微软亲儿子，2025 年 12 月才正式发布

看起来选择很多，但用下来发现一个共同问题：**它们大多只关心"把数字填对"，而不太在意"怎么填"。**

换句话说，它们会给你一个能跑的结果，但未必是一个"专业"的结果。

---

## Claude 的 xlsx Skill：一个有点"轴"的选择

后来我试了 Claude 官方的 xlsx Skill，发现这东西有点意思。

它最明显的特点就是：**坚持用公式，拒绝硬编码**。

举个例子，你让它算销售总额，普通的 AI 可能直接给你填个数字。但 xlsx Skill 会写成 `=SUM(B2:B9)`，然后调用 LibreOffice 把公式结果算出来。

听起来多此一举？其实不是。

这背后有个技术限制：Python 的 openpyxl 库只能往单元格里写公式字符串，但它不会真的去算。就像一个打字员，只负责把公式"抄"进去，但不懂数学。

所以 xlsx Skill 引入了 LibreOffice 作为"计算引擎"——让这个"会计"过一遍，把每个公式的答案都填上。

这个设计虽然多了一步，但好处是：

1. **公式保留了**，源数据变了，结果会跟着变
2. **结果也有了**，其他程序读取时不会拿到空值
3. **可以验证**，一眼就能看出计算逻辑对不对

---

## 华尔街投行的那套规范，它也给你用上了

更让我意外的是，这个 Skill 里还内置了一套财务模型的颜色编码标准。

查了一下，这还真不是随便定的。这是华尔街投行（高盛、摩根士丹利、JP 摩根那些）的内部培训标准：

| 颜色 | 含义 |
|------|------|
| 蓝色文字 | 硬编码输入值（用户可改的假设） |
| 黑色文字 | 公式和计算 |
| 绿色文字 | 来自同工作簿其他表的链接 |
| 红色文字 | 来自外部文件的链接 |
| 黄色背景 | 需要关注的关键假设 |

还有数字格式的规范：

- 负数用括号 `(123)` 而不是 `-123`
- 零值显示为 `-`
- 百分比保留一位小数 `0.0%`
- 倍数格式用 `0.0x`（比如 EV/EBITDA）

说实话，我之前做表格从来没讲究过这些。但如果你经常要把报表交给专业人士看，这些细节确实能体现"专业度"。

---

## 实际用下来的真实感受

当然，也不是说 xlsx Skill 就完美无缺。

我实测下来，发现几个问题：

**1. 表头识别还是会出错**

无论是用 Claude Code 加载 xlsx Skill，还是用 Formula Bot，都不太能自动识别"表头在第二行"这种情况。需要在提示词里明确说"从第 3 行开始填写"。

有意思的是，我顺手测了一下 OpenAI 的 Codex，它倒是正确识别出了表头位置——但生成的公式里出现了 `#DIV/0!` 错误。

**2. 提示词需要迭代**

这不是 xlsx Skill 独有的问题，但值得强调：如果效果不理想，应该修改提示词从头来，而不是让 AI 接着改。接着改容易越改越乱。

**3. 一定要备份**

这个不用多说了。

---

## 什么情况下值得用 xlsx Skill？

总结一下我的判断：

**完美契合的场景：**
- 财务报表分析与建模
- 需要自动化处理、结果要给程序用
- 你的电脑装了 LibreOffice

**可以用的场景：**
- 处理各种复杂表格（.xlsx、.xlsm、.csv、.tsv）
- 需要用到公式、希望保留计算逻辑

**可有可无的场景：**
- 一次性的简单表格处理
- 没有规范化要求
- 不需要用到公式

---

## 一个关于"专用化"的思考

xlsx Skill 内置的是华尔街投行的规范。但说实话，大多数人用不到这套标准。

你可能有自己的一套规范——颜色代表什么、数字怎么格式化、注释怎么写。

这就是 Skill 有意思的地方：**它不是一个固定的工具，而是一个可以调整的"专业知识包"**。

Claude 官方的 xlsx Skill 是个不错的起点。但如果你的工作流程足够复杂、足够有规律，完全可以在它基础上定制一个属于自己的版本。

---

## 一个小吐槽

最后说个题外话。

我顺手试了一下 WPS 的 AI 插件。它支持从单元格唤起 AI，这个设计本来挺好的——但结果呢，它让我"复制"内容。

在表格里唤起 AI，结果还要复制粘贴？这不搞笑么。

相比之下，像 SheetAI 这样的 Google Sheets 插件，至少能直接在单元格里操作。如果你经常处理表格，又不想走"对话式"的路线，这类工具倒是值得看看。

但不管选什么工具，有一点是共通的：**AI 处理表格，目前都还会犯小错误**。关键是你得知道怎么发现问题、怎么迭代提示词。

没有银弹，但有方法。

---

# 写作策略总结

## 素材转化过程

1. **技术原理简化**：将 openpyxl + LibreOffice 的技术细节，用"打字员 vs 会计"的比喻来解释，降低理解门槛
2. **市场调研精简**：从详细的市场报告中提取关键对比点，避免堆砌数据
3. **个人体验前置**：用真实的使用感受（表头识别问题、提示词迭代）增加可信度
4. **规范介绍场景化**：华尔街投行规范不是干巴巴地列出来，而是放在"为什么需要专业度"的语境下

## 应用的写作技巧

- **口语化表达**："这不搞笑么"、"有点意思"、"说实话"
- **真实试错过程**：明确指出 xlsx Skill 的问题（表头识别、需要迭代）
- **对比法**：公式 vs 硬编码、能跑 vs 专业、打字员 vs 会计
- **具象比喻**：openpyxl 是打字员，LibreOffice 是会计
- **克制的情感表达**：避免"太强了"、"炸裂"等夸张词汇

## 结构决策

- 开头用问题导入（你有没有试过），快速建立共鸣
- 中间穿插市场背景，让读者知道这不是孤立的工具介绍
- 结尾落脚在"可定制性"和"方法论"，提供更高层次的思考

---

# 可选增强建议

1. **配图**：可以加一张公式 vs 硬编码的对比截图，视觉上更直观
2. **代码片段**：如果读者偏技术向，可以加一小段 openpyxl 写公式的示例代码
3. **使用场景表格**：把"完美契合/可以用/可有可无"做成一个简洁的表格，方便快速判断
